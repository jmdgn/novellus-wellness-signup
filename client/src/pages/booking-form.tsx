import { useState } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { useBookingForm } from "@/hooks/use-booking-form";
import ContactStep from "@/components/form-steps/contact-step";
import TimePreferencesStep from "@/components/form-steps/time-preferences-step";
import MedicalDeclarationStep from "@/components/form-steps/medical-declaration-step";
import PaymentStep from "@/components/form-steps/payment-step";
import FormNavigation from "@/components/form-navigation";

export default function BookingForm() {
  const [currentStep, setCurrentStep] = useState(1);
  const { formData, updateFormData, submitBooking, isSubmitting } = useBookingForm();

  const handleNext = () => {
    if (currentStep < 4) {
      setCurrentStep(currentStep + 1);
    }
  };

  const handlePrevious = () => {
    if (currentStep > 1) {
      setCurrentStep(currentStep - 1);
    }
  };

  const renderCurrentStep = () => {
    switch (currentStep) {
      case 1:
        return (
          <ContactStep
            data={formData.contact}
            onUpdate={(data) => updateFormData({ contact: data })}
            onNext={handleNext}
          />
        );
      case 2:
        return (
          <TimePreferencesStep
            data={formData.timePreferences}
            onUpdate={(data) => updateFormData({ timePreferences: data })}
            onNext={handleNext}
            onPrevious={handlePrevious}
          />
        );
      case 3:
        return (
          <MedicalDeclarationStep
            data={formData.medical}
            onUpdate={(data) => updateFormData({ medical: data })}
            onNext={handleNext}
            onPrevious={handlePrevious}
          />
        );
      case 4:
        return (
          <PaymentStep
            formData={formData}
            onPrevious={handlePrevious}
            submitBooking={submitBooking}
            isSubmitting={isSubmitting}
          />
        );
      default:
        return null;
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center p-4 ocean-gradient">
      {/* Logo */}
      <div className="absolute top-6 left-6">
        <svg width="117" height="40" viewBox="0 0 117 40" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0_4321_3704)">
            <path d="M83.8072 39.24C83.5612 39.24 83.3257 39.2055 83.1007 39.1365C82.8757 39.0645 82.6972 38.973 82.5652 38.862L82.7677 38.4075C82.8937 38.5065 83.0497 38.589 83.2357 38.655C83.4217 38.721 83.6122 38.754 83.8072 38.754C83.9722 38.754 84.1057 38.736 84.2077 38.7C84.3097 38.664 84.3847 38.616 84.4327 38.556C84.4807 38.493 84.5047 38.4225 84.5047 38.3445C84.5047 38.2485 84.4702 38.172 84.4012 38.115C84.3322 38.055 84.2422 38.0085 84.1312 37.9755C84.0232 37.9395 83.9017 37.9065 83.7677 37.8765C83.6337 37.8465 83.4802 37.8075 83.3072 37.7595C83.0252 37.6785 82.7872 37.5675 82.5932 37.4265C82.3992 37.2855 82.2517 37.1205 82.1507 36.9315C82.0527 36.7395 82.0037 36.526 82.0037 36.291C82.0037 35.994 82.0737 35.733 82.2137 35.508C82.3537 35.283 82.5507 35.1075 82.8047 34.9815C83.0617 34.8525 83.3582 34.788 83.6942 34.788C83.9432 34.788 84.1877 34.8225 84.4277 34.8915C84.6677 34.9575 84.8672 35.046 84.9992 35.157L84.7967 35.6115C84.6707 35.5125 84.5147 35.43 84.3287 35.364C84.1427 35.298 83.9522 35.265 83.7572 35.265C83.5922 35.265 83.4587 35.283 83.3567 35.319C83.2547 35.355 83.1797 35.403 83.1317 35.463C83.0837 35.523 83.0597 35.5905 83.0597 35.6655C83.0597 35.7615 83.0942 35.838 83.1632 35.895C83.2322 35.952 83.3222 35.9985 83.4332 36.0345C83.5442 36.0675 83.6657 36.1005 83.7977 36.1335C83.9327 36.1635 84.0862 36.201 84.2582 36.246C84.5402 36.327 84.7782 36.438 84.9722 36.579C85.1662 36.72 85.3137 36.885 85.4147 37.074C85.5157 37.263 85.5662 37.473 85.5662 37.704C85.5662 38.001 85.4947 38.2635 85.3517 38.4915C85.2117 38.7165 85.0132 38.892 84.7562 39.018C84.5022 39.144 84.2057 39.207 83.8672 39.207L83.8072 39.24Z" fill="black"/>
            <path d="M76.252 39.24C76.006 39.24 75.7705 39.2055 75.5455 39.1365C75.3205 39.0645 75.142 38.973 75.01 38.862L75.2125 38.4075C75.3385 38.5065 75.4945 38.589 75.6805 38.655C75.8665 38.721 76.057 38.754 76.252 38.754C76.417 38.754 76.5505 38.736 76.6525 38.7C76.7545 38.664 76.8295 38.616 76.8775 38.556C76.9255 38.493 76.9495 38.4225 76.9495 38.3445C76.9495 38.2485 76.915 38.172 76.846 38.115C76.777 38.055 76.687 38.0085 76.576 37.9755C76.468 37.9395 76.3465 37.9065 76.2115 37.8765C76.0765 37.8465 75.923 37.8075 75.75 37.7595C75.468 37.6785 75.23 37.5675 75.036 37.4265C74.842 37.2855 74.6945 37.1205 74.5935 36.9315C74.4955 36.7395 74.4465 36.526 74.4465 36.291C74.4465 35.994 74.5165 35.733 74.6565 35.508C74.7965 35.283 74.9935 35.1075 75.2475 34.9815C75.5045 34.8525 75.801 34.788 76.137 34.788C76.386 34.788 76.6305 34.8225 76.8705 34.8915C77.1105 34.9575 77.31 35.046 77.442 35.157L77.2395 35.6115C77.1135 35.5125 76.9575 35.43 76.7715 35.364C76.5855 35.298 76.395 35.265 76.2 35.265C76.035 35.265 75.9015 35.283 75.7995 35.319C75.6975 35.355 75.6225 35.403 75.5745 35.463C75.5265 35.523 75.5025 35.5905 75.5025 35.6655C75.5025 35.7615 75.537 35.838 75.606 35.895C75.675 35.952 75.765 35.9985 75.876 36.0345C75.987 36.0675 76.1085 36.1005 76.2405 36.1335C76.3755 36.1635 76.529 36.201 76.701 36.246C76.983 36.327 77.221 36.438 77.415 36.579C77.609 36.72 77.7565 36.885 77.8575 37.074C77.9585 37.263 78.009 37.473 78.009 37.704C78.009 38.001 77.9375 38.2635 77.7945 38.4915C77.6545 38.7165 77.456 38.892 77.199 39.018C76.945 39.144 76.6485 39.207 76.31 39.207L76.252 39.24Z" fill="black"/>
            <path d="M68.0759 37.3545H69.6419V37.836H68.0759V37.3545ZM68.1209 38.7045H69.8984V39.195H67.5359V36.045H69.8354V36.5355H68.1209V38.7045Z" fill="black"/>
            <path d="M59.1677 39.195V36.045H59.6492L61.6247 38.4705H61.3862V36.045H61.9667V39.195H61.4852L59.5097 36.7695H59.7482V39.195H59.1677Z" fill="black"/>
            <path d="M51.749 39.195V36.045H52.334V38.7H53.981V39.195H51.749Z" fill="black"/>
            <path d="M44.3301 39.195V36.045H44.9151V38.7H46.5621V39.195H44.3301Z" fill="black"/>
            <path d="M37.1306 37.3545H38.6966V37.836H37.1306V37.3545ZM37.1756 38.7045H38.9531V39.195H36.5906V36.045H38.8901V36.5355H37.1756V38.7045Z" fill="black"/>
            <path d="M27.5279 39.195L26.4839 36.045H27.0914L28.0229 38.8935H27.7214L28.6889 36.045H29.2289L30.1694 38.8935H29.8769L30.8309 36.045H31.3889L30.3449 39.195H29.7239L28.8644 36.6255H29.0264L28.1534 39.195H27.5279Z" fill="black"/>
            <path d="M98.4892 27.7306C99.6209 27.7306 100.852 25.7641 99.347 25.7641C98.2183 25.7646 96.985 27.7306 98.4892 27.7306Z" fill="black"/>
            <path d="M53.1529 14.6226C52.8538 14.0016 51.1516 15.3543 50.6322 15.8075C48.3113 17.8579 46.1808 20.0285 43.9151 22.1188C44.6372 20.5087 45.3229 18.85 45.82 17.1297C45.508 16.724 45.2107 16.1617 44.6972 16.0761C44.4615 16.0333 44.2776 16.313 44.1989 16.585C43.334 19.6509 41.9367 22.4343 40.6018 25.3143C40.2287 26.1328 41.4978 26.5362 42.0155 26.0566C45.5409 22.7239 49.1897 19.5331 52.5036 15.9893C52.7533 15.7319 53.2351 14.8031 53.1529 14.6226Z" fill="black"/>
            <path d="M61.0484 19.125C59.2052 20.8459 56.8637 22.0256 54.5364 22.9362C53.0469 23.5137 48.6319 24.6383 50.3846 21.5917C51.4563 19.7477 53.5598 18.1394 55.5258 17.3848C56.1175 17.1555 56.5359 17.5712 56.1892 18.1224C55.9072 18.5715 55.3878 18.9855 54.9653 19.2851C53.7161 20.1933 51.9305 20.6501 50.4581 20.0784C49.542 19.7231 48.3575 21.1004 49.505 21.5395C52.353 22.643 58.0142 20.86 58.4478 17.3203C58.6429 15.7325 56.9672 15.4739 55.7409 15.7466C53.8096 16.1822 52.1409 17.4246 50.6943 18.8693C49.2477 20.314 48.5603 22.2589 49.0827 23.8061C49.4417 24.8969 50.6539 25.5324 51.7187 25.1537C53.4114 24.5601 54.9653 23.4046 56.4048 22.2095C57.1422 21.6053 59.0201 19.9452 60.1065 18.7298C60.3186 18.4854 61.261 18.8587 61.0484 19.125Z" fill="black"/>
            <path d="M92.858 23.5577C93.5413 24.2894 94.9591 26.0472 93.6336 26.905C93.0483 27.2996 92.2058 27.3125 91.5289 27.3454C91.2715 27.3548 88.2502 27.2504 89.4266 25.9329C89.9007 25.3946 90.6887 25.0411 91.3168 24.7086C92.8233 23.9077 94.4426 23.3055 96.0561 22.7784C99.1843 21.7623 102.38 20.9473 105.615 20.3475C107.302 20.0397 109.009 19.8133 110.72 19.665C111.858 19.5653 113.892 19.2176 114.898 19.9447C115.64 20.48 116.966 19.3431 116.17 18.765C114.861 17.8245 112.927 18.0256 111.4 18.2445C109.626 18.5011 107.855 18.8658 106.107 19.2939C102.721 20.1213 99.3965 21.205 96.1456 22.5234C94.3639 23.2451 92.6075 24.0566 90.8888 24.9479C90.1555 25.3425 89.1914 25.7618 88.5604 26.4223C88.1103 26.9394 88.8507 27.6264 89.3579 27.0809C90.1084 26.2718 91.3309 25.5559 92.2688 24.9479C92.7906 24.6189 93.3582 24.2926 93.8576 23.9077C94.4097 24.1964 92.4177 23.1056 92.858 23.5577Z" fill="black"/>
            <path d="M101.308 17.4158C102.243 16.3481 101.796 15.5279 100.635 14.9656C99.3454 14.3482 97.853 14.7129 96.5973 15.2089C94.9745 15.8632 93.3005 17.1837 92.1812 18.5058C90.7951 20.13 91.5348 21.4006 92.7382 22.711C93.0231 23.0224 94.6542 23.4961 94.0526 22.8412C93.2159 21.9288 92.794 21.3191 93.2664 20.0661C93.6665 18.9919 94.7271 18.235 95.6179 17.5982C96.3905 17.0424 97.1831 16.5129 98.0416 16.1007C98.8436 15.7184 100.934 15.2886 99.7273 16.6618C99.4982 16.9216 100.944 17.8233 101.308 17.4158Z" fill="black"/>
            <path d="M44.6578 18.8946C44.5626 18.643 44.2653 18.4572 43.9521 18.4572C43.7553 18.4572 43.7224 18.3921 43.5878 18.5093C43.0367 18.9984 41.2504 19.8139 40.3867 19.8139C40.1429 19.8139 39.9719 19.7553 39.899 19.6545C39.8362 19.5818 39.8203 19.4662 39.8485 19.3197C39.9566 19.1221 40.1875 18.643 40.1875 18.643C40.308 18.3733 40.2539 18.2045 40.1911 18.0954C40.0706 17.906 39.8062 17.7981 39.4689 17.7981C39.1252 17.7981 38.701 17.9242 38.4748 18.2045L38.4319 18.2566C38.1387 18.7081 37.9219 19.2316 37.8743 19.7868C37.8485 20.0761 37.8771 20.3431 37.964 20.5866C38.0562 20.7948 38.1852 20.9331 38.3539 21.0151C38.5462 21.1066 38.8063 21.1537 39.1288 21.1537C39.3492 21.1537 39.8909 21.0915 40.7723 20.4307C41.656 19.7699 42.8871 19.0011 43.6327 18.4842C44.0828 18.8028 44.4736 18.9032 44.6578 18.8946Z" fill="black"/>
            <path d="M35.9575 9.52028C33.8816 9.18431 31.6036 9.98935 29.6817 10.6513C27.2215 11.4962 24.8977 12.8454 22.5627 13.9723C20.6778 14.877 16.3538 17.8298 15.1493 18.5058C17.4214 16.8184 23.3829 12.4144 25.6504 10.6771C26.9119 9.71025 28.1893 8.74339 29.3656 7.66982C30.0618 7.02192 30.6177 6.26027 30.6347 5.16442C30.6747 2.67133 28.0547 1.51626 26.0047 1.13749C20.2218 0.0691887 14.2121 1.55144 9.01389 4.09436C6.22763 5.46228 3.70108 7.19254 1.88548 9.75306C0.26614 12.0497 0.0616651 15.0966 1.48883 17.7012C2.51389 19.5452 3.91883 21.0151 5.39389 22.4621C7.15554 24.1857 9.1263 25.5995 11.2915 26.7676C17.3521 29.9996 24.1201 30.9066 30.6377 30.9554C30.6482 30.8211 31.1678 29.5083 30.3655 29.5083C24.2424 29.5083 17.7871 28.7131 12.1548 25.7147C10.1454 24.6383 8.32842 23.3318 6.75025 21.7629C5.4263 20.4461 4.23448 18.9349 3.52389 17.1697C3.08601 16.0239 2.9856 14.5839 3.49324 13.4734C4.00089 12.3628 4.96366 11.4962 6.0239 10.8354C8.68836 9.22192 11.6266 8.10961 14.6413 7.46643C17.5407 6.84856 20.5836 6.53075 23.5612 7.24457C23.9173 7.32557 25.3616 7.53075 25.5145 8.31426C25.8048 9.77546 24.3428 10.8354 23.1983 11.5879C20.6214 13.2598 17.6967 14.6538 14.9587 16.0761C14.2309 16.4395 10.9718 18.1571 11.8826 18.9984C12.7969 19.8396 15.8728 18.0342 17.13 17.1274C21.8653 14.0016 26.5394 10.7415 31.6671 8.47339C32.3938 8.12191 33.1804 7.87723 33.9575 7.75192C33.2838 8.26963 36.5323 9.21662 35.9575 9.52028Z" fill="black"/>
            <path d="M91.9484 19.6169C91.9307 19.6375 91.6399 19.9805 91.6399 19.9805C91.1863 20.4953 90.2785 21.4352 89.0816 22.1065C87.8712 22.7785 86.776 23.2422 86.3159 23.3777C83.8428 24.1346 85.4058 22.1317 85.4058 22.1317C85.632 21.8075 85.8135 21.5577 85.9034 21.441C87.0339 20.0115 88.47 18.3434 89.9089 17.2376C90.2139 17.0042 88.5551 16.3106 88.128 16.6407C86.0997 18.2045 83.7529 19.4504 81.6218 20.8787C80.724 21.4768 79.8186 22.0608 78.9413 22.6987C78.5618 22.969 78.1716 23.2129 77.792 23.4875C77.349 23.809 76.9237 24.1657 76.516 24.5583C76.1542 24.9085 75.9662 25.8296 76.7002 25.9687C78.3555 26.2947 80.9649 24.6777 82.5793 23.6481C85.632 21.7158 88.4064 19.2968 91.1158 16.8496C91.3844 16.6153 91.8698 19.2159 91.9484 19.6169Z" fill="black"/>
            <path d="M68.5542 20.2361C65.9118 22.2466 63.3477 24.3428 60.6343 26.2589C59.6154 26.9701 58.4421 27.9077 57.2117 28.2061C56.4966 28.3732 58.4415 29.326 58.418 28.6318C58.4115 28.3709 58.5143 28.09 58.5872 27.8414C58.8105 27.1167 59.1624 26.4225 59.4979 25.747C63.4047 17.7694 69.355 10.2749 76.4587 4.93575C76.4094 4.97797 75.1056 3.83755 74.7401 4.10785C70.12 7.57953 66.3102 11.8293 62.9088 16.4865C60.5732 19.6715 57.8351 23.4046 56.7998 27.2475C56.4643 28.4805 56.9819 28.9361 57.7724 28.6146C58.9107 28.1398 59.8885 27.1585 60.6343 26.2589C63.3477 24.3428 65.9118 22.2466 68.5542 20.2361C69.2685 19.7046 70.0096 18.157 68.5542 20.2361Z" fill="black"/>
            <path d="M83.5042 2.67073C78.578 6.76685 74.2952 11.7542 70.6446 17.0101C69.2368 19.0364 67.9718 21.1631 66.7861 23.3225C66.0616 24.6348 64.756 26.5181 64.8289 28.0988C64.8582 28.7754 65.5439 29.2861 66.8037 29.3459C68.3278 29.4286 70.5547 27.2275 71.6552 26.3967C74.4039 24.3258 77.0879 22.1393 79.7954 20.0162C79.7543 20.0496 79.2049 18.5093 78.86 18.7855C76.7242 20.4554 73.8163 22.5234 71.6958 24.202C70.1399 25.4333 68.564 26.6758 66.8636 27.7054C66.598 27.8672 66.3254 28.0109 66.0528 28.1327C65.9836 28.1616 65.9132 28.1886 65.8418 28.2137C65.6253 28.2976 65.6982 27.8249 65.7176 27.6264C65.8141 26.5698 66.5033 25.5088 67.0387 24.5979C68.1356 22.6987 69.3048 20.8486 70.533 19.0364C74.2952 13.508 78.8225 8.30845 84.0465 4.16751C84.335 3.93988 84.9825 2.30961 83.5042 2.67073Z" fill="black"/>
          </g>
          <defs>
            <clipPath id="clip0_4321_3704">
              <rect width="117" height="39.5166" fill="white"/>
            </clipPath>
          </defs>
        </svg>
      </div>
      {/* Main Form Container */}
      <div className="w-full max-w-lg">
        <div className="form-card pt-[32px] pb-[32px] text-[#555555]">
          {renderCurrentStep()}
        </div>

        {/* Progress Bar */}
        <div className="mt-6">
          <div className="bg-white/20 rounded-full h-2 backdrop-blur-sm">
            <div 
              className="bg-white rounded-full h-2 progress-bar" 
              style={{ width: `${(currentStep / 4) * 100}%` }}
            />
          </div>
        </div>
      </div>
    </div>
  );
}
