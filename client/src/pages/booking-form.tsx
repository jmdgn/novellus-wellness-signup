import { useState } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { useBookingForm } from "@/hooks/use-booking-form";
import ContactStep from "@/components/form-steps/contact-step";
import TimePreferencesStep from "@/components/form-steps/time-preferences-step";
import MedicalDeclarationStep from "@/components/form-steps/medical-declaration-step";
import PaymentStep from "@/components/form-steps/payment-step";
import FormNavigation from "@/components/form-navigation";

export default function BookingForm() {
  const [currentStep, setCurrentStep] = useState(1);
  const { formData, updateFormData, submitBooking, isSubmitting } = useBookingForm();

  const handleNext = () => {
    if (currentStep < 4) {
      setCurrentStep(currentStep + 1);
    }
  };

  const handlePrevious = () => {
    if (currentStep > 1) {
      setCurrentStep(currentStep - 1);
    }
  };

  const renderCurrentStep = () => {
    switch (currentStep) {
      case 1:
        return (
          <ContactStep
            data={formData.contact}
            onUpdate={(data) => updateFormData({ contact: data })}
            onNext={handleNext}
          />
        );
      case 2:
        return (
          <TimePreferencesStep
            data={formData.timePreferences}
            onUpdate={(data) => updateFormData({ timePreferences: data })}
            onNext={handleNext}
            onPrevious={handlePrevious}
          />
        );
      case 3:
        return (
          <MedicalDeclarationStep
            data={formData.medical}
            onUpdate={(data) => updateFormData({ medical: data })}
            onNext={handleNext}
            onPrevious={handlePrevious}
          />
        );
      case 4:
        return (
          <PaymentStep
            formData={formData}
            onPrevious={handlePrevious}
            submitBooking={submitBooking}
            isSubmitting={isSubmitting}
          />
        );
      default:
        return null;
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center p-4 ocean-gradient">
      {/* Logo */}
      <div className="absolute top-6 left-6">
        <svg width="117" height="40" viewBox="0 0 117 40" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clipPath="url(#clip0_4315_1343)">
            <path d="M83.8071 39.24C83.5611 39.24 83.3256 39.2055 83.1006 39.1365C82.8756 39.0645 82.6971 38.973 82.5651 38.862L82.7676 38.4075C82.8936 38.5065 83.0496 38.589 83.2356 38.655C83.4216 38.721 83.6121 38.754 83.8071 38.754C83.9721 38.754 84.1056 38.736 84.2076 38.7C84.3096 38.664 84.3846 38.616 84.4326 38.556C84.4806 38.493 84.5046 38.4225 84.5046 38.3445C84.5046 38.2485 84.4701 38.172 84.4011 38.115C84.3321 38.055 84.2421 38.0085 84.1311 37.9755C84.0231 37.9395 83.9016 37.9065 83.7676 37.8765C83.6336 37.8465 83.4801 37.8075 83.3071 37.7595C83.0251 37.6785 82.7871 37.5675 82.5931 37.4265C82.3991 37.2855 82.2516 37.1205 82.1506 36.9315C82.0526 36.7395 82.0036 36.526 82.0036 36.291C82.0036 35.994 82.0736 35.733 82.2136 35.508C82.3536 35.283 82.5506 35.1075 82.8046 34.9815C83.0616 34.8525 83.3581 34.788 83.6941 34.788C83.9431 34.788 84.1876 34.8225 84.4276 34.8915C84.6676 34.9575 84.8671 35.046 84.9991 35.157L84.7966 35.6115C84.6706 35.5125 84.5146 35.43 84.3286 35.364C84.1426 35.298 83.9521 35.265 83.7571 35.265C83.5921 35.265 83.4586 35.283 83.3566 35.319C83.2546 35.355 83.1796 35.403 83.1316 35.463C83.0836 35.523 83.0596 35.5905 83.0596 35.6655C83.0596 35.7615 83.0941 35.838 83.1631 35.895C83.2321 35.952 83.3221 35.9985 83.4331 36.0345C83.5441 36.0675 83.6656 36.1005 83.7976 36.1335C83.9326 36.1635 84.0861 36.201 84.2581 36.246C84.5401 36.327 84.7781 36.438 84.9721 36.579C85.1661 36.72 85.3136 36.885 85.4146 37.074C85.5156 37.263 85.5661 37.473 85.5661 37.704C85.5661 38.001 85.4946 38.2635 85.3516 38.4915C85.2116 38.7165 85.0131 38.892 84.7561 39.018C84.5021 39.144 84.2056 39.207 83.8671 39.207L83.8071 39.24Z" fill="black"/>
            <path d="M76.252 39.24C76.006 39.24 75.7705 39.2055 75.5455 39.1365C75.3205 39.0645 75.142 38.973 75.01 38.862L75.2125 38.4075C75.3385 38.5065 75.4945 38.589 75.6805 38.655C75.8665 38.721 76.057 38.754 76.252 38.754C76.417 38.754 76.5505 38.736 76.6525 38.7C76.7545 38.664 76.8295 38.616 76.8775 38.556C76.9255 38.493 76.9495 38.4225 76.9495 38.3445C76.9495 38.2485 76.915 38.172 76.846 38.115C76.777 38.055 76.687 38.0085 76.576 37.9755C76.468 37.9395 76.3465 37.9065 76.2115 37.8765C76.0765 37.8465 75.923 37.8075 75.75 37.7595C75.468 37.6785 75.23 37.5675 75.036 37.4265C74.842 37.2855 74.6945 37.1205 74.5935 36.9315C74.4955 36.7395 74.4465 36.526 74.4465 36.291C74.4465 35.994 74.5165 35.733 74.6565 35.508C74.7965 35.283 74.9935 35.1075 75.2475 34.9815C75.5045 34.8525 75.801 34.788 76.137 34.788C76.386 34.788 76.6305 34.8225 76.8705 34.8915C77.1105 34.9575 77.31 35.046 77.442 35.157L77.2395 35.6115C77.1135 35.5125 76.9575 35.43 76.7715 35.364C76.5855 35.298 76.395 35.265 76.2 35.265C76.035 35.265 75.9015 35.283 75.7995 35.319C75.6975 35.355 75.6225 35.403 75.5745 35.463C75.5265 35.523 75.5025 35.5905 75.5025 35.6655C75.5025 35.7615 75.537 35.838 75.606 35.895C75.675 35.952 75.765 35.9985 75.876 36.0345C75.987 36.0675 76.1085 36.1005 76.2405 36.1335C76.3755 36.1635 76.529 36.201 76.701 36.246C76.983 36.327 77.221 36.438 77.415 36.579C77.609 36.72 77.7565 36.885 77.8575 37.074C77.9585 37.263 78.009 37.473 78.009 37.704C78.009 38.001 77.9375 38.2635 77.7945 38.4915C77.6545 38.7165 77.456 38.892 77.199 39.018C76.945 39.144 76.6485 39.207 76.31 39.207L76.252 39.24Z" fill="black"/>
            <path d="M68.0758 37.3545H69.6418V37.836H68.0758V37.3545ZM68.1208 38.7045H69.8983V39.195H67.5358V36.045H69.8353V36.5355H68.1208V38.7045Z" fill="black"/>
            <path d="M59.1678 39.195V36.045H59.6493L61.6248 38.4705H61.3863V36.045H61.9668V39.195H61.4853L59.5098 36.7695H59.7483V39.195H59.1678Z" fill="black"/>
            <path d="M51.7489 39.195V36.045H52.3339V38.7H53.9809V39.195H51.7489Z" fill="black"/>
            <path d="M44.3301 39.195V36.045H44.9151V38.7H46.5621V39.195H44.3301Z" fill="black"/>
            <path d="M37.1304 37.3545H38.6964V37.836H37.1304V37.3545ZM37.1754 38.7045H38.9529V39.195H36.5904V36.045H38.8899V36.5355H37.1754V38.7045Z" fill="black"/>
            <path d="M27.5279 39.195L26.4839 36.045H27.0914L28.0229 38.8935H27.7214L28.6889 36.045H29.2289L30.1694 38.8935H29.8769L30.8309 36.045H31.3889L30.3449 39.195H29.7239L28.8644 36.6255H29.0264L28.1534 39.195H27.5279Z" fill="black"/>
            <path d="M98.4892 27.7306C99.6209 27.7306 100.852 25.7641 99.347 25.7641C98.2183 25.7646 96.985 27.7306 98.4892 27.7306Z" fill="black"/>
            <path d="M53.1529 14.6226C52.8538 14.0016 51.1516 15.3543 50.6322 15.8075C48.3113 17.8579 46.1807 20.0285 43.9151 22.1188C44.6372 20.5087 45.3229 18.85 45.82 17.1297C45.508 16.724 45.2107 16.1617 44.6971 16.0761C44.4615 16.0333 44.2776 16.313 44.1989 16.585C43.334 19.6509 41.9367 22.4343 40.6018 25.3143C40.2287 26.1328 41.4978 26.5362 42.0155 26.0566C45.5409 22.7239 49.1897 19.5331 52.5036 15.9893C52.7533 15.7319 53.2351 14.8031 53.1529 14.6226Z" fill="black"/>
            <path d="M61.0485 19.125C59.2053 20.8459 56.8639 22.0256 54.5365 22.9362C53.047 23.5137 48.632 24.6383 50.3847 21.5917C51.4565 19.7477 53.56 18.1394 55.526 17.3848C56.1177 17.1555 56.536 17.5712 56.1893 18.1224C55.9073 18.5715 55.3879 18.9855 54.9654 19.2851C53.7163 20.1933 51.9306 20.6501 50.4582 20.0784C49.5422 19.7231 48.3576 21.1004 49.5051 21.5395C52.3531 22.643 58.0143 20.86 58.448 17.3203C58.643 15.7325 56.9673 15.4739 55.741 15.7466C53.8097 16.1822 52.141 17.4246 50.6944 18.8693C49.2478 20.314 48.5604 22.2589 49.0828 23.8061C49.4418 24.8969 50.654 25.5324 51.7188 25.1537C53.4115 24.5601 54.9654 23.4046 56.4049 22.2095C57.1423 21.6053 59.0202 19.9452 60.1066 18.7298C60.3187 18.4854 61.2611 18.8587 61.0485 19.125Z" fill="black"/>
            <path d="M92.8579 23.5577C93.5413 24.2894 94.9591 26.0472 93.6335 26.905C93.0483 27.2996 92.2057 27.3125 91.5288 27.3454C91.2715 27.3548 88.2502 27.2504 89.4265 25.9329C89.9007 25.3946 90.6886 25.0411 91.3167 24.7086C92.8233 23.9077 94.4426 23.3055 96.0561 22.7784C99.1843 21.7623 102.38 20.9473 105.615 20.3475C107.302 20.0397 109.009 19.8133 110.719 19.665C111.858 19.5653 113.892 19.2176 114.898 19.9447C115.64 20.48 116.966 19.3431 116.17 18.765C114.861 17.8245 112.927 18.0256 111.41 18.2445C109.626 18.5011 107.855 18.8658 106.107 19.2939C102.721 20.1213 99.3964 21.205 96.1455 22.5234C94.3638 23.2451 92.6074 24.0566 90.8887 24.9479C90.1554 25.3425 89.1913 25.7618 88.5603 26.4223C88.1102 26.9394 88.8506 27.6264 89.3578 27.0809C90.1083 26.2718 91.3308 25.5559 92.2687 24.9479C92.7905 24.6189 93.3581 24.2926 93.8575 23.9077C94.4096 24.1964 92.4176 23.1056 92.8579 23.5577Z" fill="black"/>
            <path d="M101.308 17.4158C102.243 16.3481 101.795 15.5279 100.634 14.9656C99.3453 14.3482 97.8529 14.7129 96.5972 15.2089C94.9744 15.8632 93.3004 17.1837 92.181 18.5058C90.795 20.13 91.5347 21.4006 92.7381 22.711C93.023 23.0224 94.6541 23.4961 94.0525 22.8412C93.2158 21.9288 92.7939 21.3191 93.2663 20.0661C93.6664 18.9919 94.727 18.235 95.6177 17.5982C96.3904 17.0424 97.183 16.5129 98.0415 16.1007C98.8435 15.7184 100.934 15.2886 99.7272 16.6618C99.4981 16.9216 100.943 17.8233 101.308 17.4158Z" fill="black"/>
            <path d="M44.6577 18.8946C44.5625 18.643 44.2652 18.4572 43.9521 18.4572C43.7552 18.4572 43.7223 18.3921 43.5878 18.5093C43.0366 18.9984 41.2504 19.8139 40.3867 19.8139C40.1428 19.8139 39.9718 19.7553 39.899 19.6545C39.8361 19.5818 39.8203 19.4662 39.8485 19.3197C39.9566 19.1221 40.1875 18.643 40.1875 18.643C40.3079 18.3733 40.2539 18.2045 40.191 18.0954C40.0706 17.906 39.8062 17.7981 39.4689 17.7981C39.1252 17.7981 38.7009 17.9242 38.4747 18.2045L38.4318 18.2566C38.1386 18.7081 37.9218 19.2316 37.8742 19.7868C37.8484 20.0761 37.877 20.3431 37.9639 20.5866C38.0561 20.7948 38.1851 20.9331 38.3538 21.0151C38.5461 21.1066 38.8062 21.1537 39.1287 21.1537C39.3491 21.1537 39.8908 21.0915 40.7722 20.4307C41.6559 19.7699 42.887 19.0011 43.6326 18.4842C44.0827 18.8028 44.4735 18.9032 44.6577 18.8946Z" fill="black"/>
            <path d="M35.9575 9.52028C33.8817 9.18431 31.6036 9.98935 29.6817 10.6513C27.2215 11.4962 24.8977 12.8454 22.5627 13.9723C20.6778 14.877 16.3538 17.8298 15.1493 18.5058C17.4215 16.8184 23.3829 12.4144 25.6504 10.6771C26.9119 9.71025 28.1893 8.74339 29.3656 7.66982C30.0619 7.02192 30.6177 6.26027 30.6347 5.16442C30.6747 2.67133 28.0547 1.51626 26.0047 1.13749C20.2218 0.0691887 14.2121 1.55144 9.01391 4.09436C6.22765 5.46228 3.70109 7.19254 1.8855 9.75306C0.266155 12.0497 0.0616803 15.0966 1.48885 17.7012C2.51391 19.5452 3.91885 21.0151 5.39391 22.4621C7.15556 24.1857 9.12632 25.5995 11.2915 26.7676C17.3521 29.9996 24.1201 30.9066 30.6377 30.9554C30.6482 30.8211 31.1678 29.5083 30.3655 29.5083C24.2424 29.5083 17.7871 28.7131 12.1548 25.7147C10.1454 24.6383 8.32844 23.3318 6.75027 21.7629C5.42632 20.4461 4.2345 18.9349 3.52391 17.1697C3.08603 16.0239 2.98562 14.5839 3.49326 13.4734C4.00091 12.3628 4.96368 11.4962 6.02392 10.8354C8.68838 9.22192 11.6266 8.10961 14.6413 7.46643C17.5407 6.84856 20.5836 6.53075 23.5612 7.24457C23.9173 7.32557 25.3616 7.53075 25.5145 8.31426C25.8048 9.77546 24.3428 10.8354 23.1983 11.5879C20.6214 13.2598 17.6967 14.6538 14.9587 16.0761C14.2309 16.4395 10.9718 18.1571 11.8826 18.9984C12.7969 19.8396 15.8728 18.0342 17.13 17.1274C21.8653 14.0016 26.5394 10.7415 31.6671 8.47339C32.3938 8.12191 33.1804 7.87723 33.9575 7.75192C33.2838 8.26963 36.5323 9.21662 35.9575 9.52028Z" fill="black"/>
            <path d="M91.9483 19.6169C91.9307 19.6375 91.6398 19.9805 91.6398 19.9805C91.1862 20.4953 90.2784 21.4352 89.0815 22.1065C87.8712 22.7785 86.7759 23.2422 86.3159 23.3777C83.8428 24.1346 85.4057 22.1317 85.4057 22.1317C85.6319 21.8075 85.8135 21.5577 85.9034 21.441C87.0339 20.0115 88.4699 18.3434 89.9088 17.2376C90.2138 17.0042 88.5551 16.3106 88.1279 16.6407C86.0996 18.2045 83.7529 19.4504 81.6218 20.8787C80.7239 21.4768 79.8185 22.0608 78.9413 22.6987C78.5617 22.969 78.1715 23.21 77.7919 23.4846C77.3489 23.8061 76.9236 24.1628 76.5159 24.5554C76.1541 24.9056 75.9661 25.8267 76.7001 25.9658C78.3554 26.2918 80.9648 24.6748 82.5792 23.6452C85.6319 21.7129 88.4063 19.2939 91.1157 16.8467C91.3843 16.6124 91.8697 19.213 91.9483 19.6169Z" fill="black"/>
            <path d="M68.5542 20.2361C65.9119 22.2466 63.3477 24.3428 60.6343 26.2589C59.6155 26.9701 58.4421 27.9077 57.2117 28.2061C56.4966 28.3732 58.4415 29.326 58.418 28.6318C58.4115 28.3709 58.5144 28.09 58.5872 27.8414C58.8105 27.1167 59.1624 26.4225 59.4979 25.747C63.4047 17.7694 69.355 10.2749 76.4588 4.93575C76.4094 4.97797 75.1056 3.83755 74.7401 4.10785C70.1201 7.57953 66.3102 11.8293 62.9088 16.4865C60.5732 19.6715 57.8351 23.4046 56.7998 27.2475C56.4643 28.4805 56.982 28.9361 57.7725 28.6146C58.9108 28.1398 59.8886 27.1585 60.6343 26.2589C63.3477 24.3428 65.9119 22.2466 68.5542 20.2361C69.2686 19.7046 70.0097 18.1571 68.5542 20.2361Z" fill="black"/>
            <path d="M83.5043 2.67073C78.5781 6.76685 74.2953 11.7542 70.6447 17.0101C69.2369 19.0364 67.9719 21.1631 66.7862 23.3225C66.0617 24.6348 64.7561 26.5181 64.829 28.0988C64.8584 28.7754 65.544 29.2861 66.8038 29.3459C68.328 29.4286 70.5549 27.2275 71.6554 26.3967C74.404 24.3258 77.088 22.1393 79.7956 20.0162C79.7544 20.0496 79.2051 18.5093 78.8602 18.7855C76.7243 20.4554 73.8165 22.5234 71.6959 24.202C70.14 25.4333 68.5642 26.6758 66.8637 27.7054C66.5981 27.8672 66.3255 28.0109 66.0529 28.1327C65.9837 28.1616 65.9133 28.1886 65.8419 28.2137C65.6254 28.2976 65.6983 27.8249 65.7177 27.6264C65.8142 26.5698 66.5034 25.5088 67.0388 24.5979C68.1357 22.6987 69.3049 20.8486 70.5331 19.0364C74.2953 13.508 78.8226 8.30845 84.0466 4.16751C84.3351 3.93988 84.9826 2.30961 83.5043 2.67073Z" fill="black"/>
          </g>
          <defs>
            <clipPath id="clip0_4315_1343">
              <rect width="117" height="39.5166" fill="white"/>
            </clipPath>
          </defs>
        </svg>
      </div>

      {/* Main Form Container */}
      <div className="w-full max-w-lg">
        <div className="form-card">
          {renderCurrentStep()}
        </div>

        {/* Progress Bar */}
        <div className="mt-6">
          <div className="bg-white/20 rounded-full h-2 backdrop-blur-sm">
            <div 
              className="bg-white rounded-full h-2 progress-bar" 
              style={{ width: `${(currentStep / 4) * 100}%` }}
            />
          </div>
        </div>
      </div>
    </div>
  );
}
